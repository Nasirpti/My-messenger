<!DOCTYPE html>
<html lang="ur"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Nasir Chat</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
body{font-family:sans-serif;margin:0;background:#e5ddd5;display:flex;flex-direction:column;height:100vh}
.hdr{background:#075e54;color:#fff;padding:10px;text-align:center}
.p-img{width:50px;height:50px;border-radius:50%;border:2px solid #fff}
#msgs{flex:1;overflow-y:auto;padding:15px;display:flex;flex-direction:column;gap:10px}
.msg{padding:8px;border-radius:10px;max-width:80%;font-size:14px;background:#fff}
.s{background:#dcf8c6;align-self:flex-end}
.in-bar{background:#f0f0f0;padding:8px;display:flex;align-items:center;gap:5px;border-top:1px solid #ccc}
#m-in{flex:1;border:none;padding:10px;border-radius:20px;outline:none}
.btn{background:#075e54;color:#fff;border:none;width:40px;height:40px;border-radius:50%;cursor:pointer}
#log{text-align:center;padding-top:100px;background:#fff;position:fixed;width:100%;height:100%;z-index:99}
</style></head><body>

<div id="log">
    <img src="my-photo.jpg" style="width:80px;border-radius:50%"><br>
    <h2>ناصر میسنجر</h2>
    <button onclick="stChat()" style="padding:12px 25px;background:#075e54;color:#fff;border-radius:25px;border:none;cursor:pointer">شروع کریں</button>
</div>

<div class="hdr">
    <img src="my-photo.jpg" class="p-img"><br>
    <b>ناصر ممتاز</b>
</div>

<div id="msgs"></div>

<div class="in-bar">
    <label for="f" style="color:#075e54;font-size:22px;cursor:pointer"><i class="fas fa-camera"></i></label>
    <input type="file" id="f" accept="image/*" style="display:none" onchange="sI(this)">
    <input type="text" id="m-in" placeholder="پیغام لکھیں...">
    <button class="btn" onclick="sT()"><i class="fas fa-paper-plane"></i></button>
</div>

<script type="module">
import {initializeApp} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {getDatabase,ref,push,onChildAdded} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
const cfg={databaseURL:"https://my-messenger-220f7-default-rtdb.firebaseio.com/"};
const app=initializeApp(cfg);const db=getDatabase(app);let u="";
window.stChat=()=>{u=prompt("آپ کا نام؟")||"مہمان";document.getElementById('log').style.display="none"};
const mRef=ref(db,'chat');
onChildAdded(mRef,(s)=>{const d=s.val();const isM=d.u===u;
let c=d.t==='x'?d.m:`<img src="${d.i}" style="max-width:100%;border-radius:8px">`;
const h=`<div class="msg ${isM?'s':''}">${c}<div style="font-size:8px;color:gray;text-align:right">${d.h}</div></div>`;
document.getElementById('msgs').insertAdjacentHTML('beforeend',h);
document.getElementById('msgs').scrollTop=document.getElementById('msgs').scrollHeight});
window.sT=()=>{const i=document.getElementById('m-in');if(i.value.trim()){
push(mRef,{u:u,m:i.value,t:'x',h:new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})});i.value=""}};
window.sI=(el)=>{const r=new FileReader();r.onload=(e)=>push(mRef,{u:u,i:e.target.result,t:'i',h:new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})});
r.readAsDataURL(el.files[0])};
</script></body></html>
                   
